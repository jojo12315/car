layui.define(["jquery","layer","laypage"],function(exports){var $=layui.jquery,laypage=layui.laypage,layer=void 0===parent.layer?layui.layer:top.layer,langs=[];langs.cn={ajaxing:"操作中，请稍后",yes:"确定",no:"取消",tips:"提示信息"},langs.hk={ajaxing:"操作中，請稍後",yes:"確定",no:"取消",tips:"提示信息"},langs.en={ajaxing:"Operation, please wait",yes:"Yes",no:"No",tips:"Tips"};var util={};"undefined"==typeof appConfig?util.lang=langs.cn:null==appConfig.lang?util.lang=langs.cn:util.lang=langs[appConfig.lang],util.ajaxing=!1,util.ajaxtimeout=!1,util.ajax=function(t,e,n,i,r,a){if("object"==typeof t){var u=t;util.ajaxByOptions(u)}else{if(null==r&&(r=!0),r){if(util.ajaxtimeout)return console.log("您操作太快了，请稍后再试"),!1;if(util.ajaxtimeout=!0,setTimeout(function(){util.ajaxtimeout=!1},500),util.ajaxing)return util.tips(util.lang.ajaxing,"danger"),!1;util.ajaxing=!0}"get"==i?$.get(t,e,function(t){util.ajaxing=!1,n(t)},"json").error(function(t){console.log(t),a&&a(),util.ajaxing=!1}):$.post(t,e,function(t){util.ajaxing=!1,n(t)},"json").error(function(t){console.log(t),a&&a(),util.ajaxing=!1})}},util.ajaxByOptions=function(t){var e={msg:"",url:"",param:{},data:"",type:"post",check:!0,success:"",error:"",tips:!0};function n(){util.ajax(e.url,e.param,function(t){e.tips?(1==t.code?util.tips(t.msg,"success"):util.tips(t.msg,"danger"),""!=e.success&&setTimeout(function(){e.success(t)},500)):""!=e.success&&e.success(t)},e.type,e.check,e.error)}$.extend(e,t),""!=e.data&&(e.param=e.data),""!=e.msg?util.sure(e.msg,function(){n()}):n()},util.submit=function(t){var e={elem:"#pageForm",action:"",before:"",success:"",tips:!0};$.extend(e,t),$(e.elem).submit(function(){""!=e.before&&e.before();var t=e.action;return""==t&&(t=$(this).attr("action")),util.ajax(t,$(this).serialize(),function(t){e.tips?(1==t.code?util.tips(t.msg,"success"):util.tips(t.msg,"danger"),""!=e.success&&setTimeout(function(){e.success(t)},500)):""!=e.success&&e.success(t)}),!1})},util.goto=function(t,e){e=e||0;setTimeout(function(){window.location.href=t},e)},util.reload=function(t){t=arguments[1]?arguments[1]:0;setTimeout(function(){location.reload()},t)},util.open=function(t,e){e=e||0;setTimeout(function(){window.open(t)},e)},util.tips=function(t,e,n){var i=1;"error"!=e&&"danger"!=e||(i=5),layer.msg(t,{time:1e3,icon:i},function(){n&&setTimeout(function(){n()},500)})},util.sure=function(t,e){return layer.confirm(t,{btn:[util.lang.yes,util.lang.no],icon:3,title:util.lang.tips},function(){e&&e()},function(){})},util.input=function(t,n,e){null==e&&(e=0),layer.prompt({title:t,formType:e},function(t,e){layer.close(e),n&&n(t)})},util.noImg=function(t,e){$(t).attr("src",__noImgSrc),1==e&&$(t).parent().attr("href",__noImgSrc)},util.back=function(t){1==t?self.location=document.referrer:history.back(-1)},util.toFloat=function(t,e,n){var i=parseFloat(t);return isNaN(i)&&(i=0),null!=e?n?parseFloat(i.toFixed(e)):i.toFixed(e):i},util.toInt=function(t){var e=parseInt(t);return isNaN(e)&&(e=0),e},util.moneyStr=function(t){return util.toFloat(t,2)},util.strMoney=function(t){return util.moneyStr(t)},util.url=function(t,e){for(var n in 0<t.indexOf("?")?t+="&":t+="?",e)"url"!=n&&null!==e[n]&&(t+=n+"="+encodeURIComponent(e[n])+"&");return t.substring(0,t.lastIndexOf("&"))},util.accAdd=function(t,e){var n,i,r;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{i=e.toString().split(".")[1].length}catch(t){i=0}return(t*(r=Math.pow(10,Math.max(n,i)))+e*r)/r},Number.prototype.add=function(t){return util.accAdd(t,this)},util.accSub=function(t,e){var n,i,r;try{n=t.toString().split(".")[1].length}catch(t){n=0}try{i=e.toString().split(".")[1].length}catch(t){i=0}return((t*(r=Math.pow(10,Math.max(n,i)))-e*r)/r).toFixed(i<=n?n:i)},Number.prototype.sub=function(t){return util.accSub(t,this)},util.accDiv=function(arg1,arg2){var t1=0,t2=0,r1,r2;try{t1=arg1.toString().split(".")[1].length}catch(t){}try{t2=arg2.toString().split(".")[1].length}catch(t){}with(Math)return r1=Number(arg1.toString().replace(".","")),r2=Number(arg2.toString().replace(".","")),r1/r2*pow(10,t2-t1)},Number.prototype.div=function(t){return util.accDiv(this,t)},util.accMul=function(t,e){var n=0,i=t.toString(),r=e.toString();try{n+=i.split(".")[1].length}catch(t){}try{n+=r.split(".")[1].length}catch(t){}return Number(i.replace(".",""))*Number(r.replace(".",""))/Math.pow(10,n)},Number.prototype.mul=function(t){return util.accMul(t,this)},util.pager=function(t){var r={elem:"pager",url:"",limit:15,jump:"",data:{},dataFun:""};$.extend(r,t);var a=0,u=1,l=!0,o=r.data,s=function(i,t){laypage.render({elem:r.elem,layout:["count","prev","page","next","skip"],count:t,curr:u,limit:r.limit,jump:function(t,e){var n=t.curr;u=n,""!=r.dataFun&&(i=r.dataFun(),console.log(i)),i.page=n,i.limit=r.limit,l&&util.ajax({url:r.url,data:i,tips:!1,check:!1,success:function(t){var e=t.data.count;e!=a&&(l=!1,s(o,a=e),l=!0),""!=r.jump&&r.jump(t)}})}})};return s(o,a),{render:function(t){s(t,a)},reload:function(){s(o,a)}}},util.inputStop=function(t){var e={elem:".input-stop",obj:"",time:1e3,done:""};if($.extend(e,t),""!=e.obj)var n=e.obj;else n=$(e.elem);var i=0,r=null;function a(){n.val()==i&&""!=e.done&&e.done(n)}n.keyup(function(){clearTimeout(r),r=setTimeout(a,e.time),i=$(this).val()})},util.dateFormat=function(t,e){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var i in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t},util.dateCalc=function(t,e){t||(t="+1 day"),e||(e=new Date);var n=t.substr(0,1),i=(t=t.substr(1,100)).split(" "),r=parseInt(i[0]),a=i[1];return"year"==a?"+"==n?e.setFullYear(e.getFullYear()+r):e.setFullYear(e.getFullYear()-r):"month"==a?"+"==n?e.setMonth(e.getMonth()+r):e.setMonth(e.getMonth()-r):"+"==n?e.setDate(e.getDate()+r):e.setDate(e.getDate()-r),util.date("Y-m-d",e)},util.date=function(t,e){if(e)if("string"==typeof e){e=(e=e.substring(0,19)).replace(/-/g,"/");n=new Date(e).getTime()}else n=e.getTime();else var n=(new Date).getTime();if(!n)return"";var i=new Date;i.setTime(n);var r=i.getMonth()+1,a=i.getDate(),u=i.getHours(),l=i.getMinutes(),o=i.getSeconds(),s={Y:i.getFullYear(),m:1==r.toString().length?"0"+r:r,d:1==a.toString().length?"0"+a:a,H:1==u.toString().length?"0"+u:u,i:1==l.toString().length?"0"+l:l,s:1==o.toString().length?"0"+o:o};for(var c in s)t=t.replace(new RegExp(c),s[c]);return t},util.formatMoney=function(t,e){if("0"==t&&0==e)return"0";if(/[^0-9\.]/.test(t))return"0.00";if(null==t||"null"==t||""==t)return"0.00";t=(t=((t=t.toString().replace(/^(\d*)$/,"$1."))+"00").replace(/(\d*\.\d\d)\d*/,"$1")).replace(".",",");for(var n=/(\d)(\d{3},)/;n.test(t);)t=t.replace(n,"$1,$2");if(t=t.replace(/,(\d\d)$/,".$1"),0==e){var i=t.split(".");if("00"==i[1])t=i[0];else{for(var r="",a=i[1].length-1;0<=a;a--)0!=i[1].charAt(a)&&(r=i[1].charAt(a)+r);t=i[0]+"."+r}}return t},util.str2json=function(t){return JSON.parse(t)},util.json2str=function(t){return JSON.stringify(t)},util.getTplWidth=function(t,e){null==e&&(e=60);var n=$('<span id="tplTemp">'+$("#"+t).html()+"</span>");$("body").append(n);var i=n.width()+35;return n.remove(),i<e&&(i=e),i},exports("kjs",util)});